// Generated by CoffeeScript 1.4.0
(function() {

  LOAF.MyCrumbsView = LOAF.BreadcrumbView.extend({
    tagName: 'div',
    className: 'bcrumbs-mycrumbs-view',
    initialize: function() {
      return this._historyRep = new LOAF.HistoryItem({
        title: "My Crumbs",
        view: this
      });
    },
    events: {
      "click .bcrumbs-list a": "onShowList",
   //   "click .bcrumbs-list-add": "onAddNewList"
    },
    onShowList: function(e) {
      var el, listId;
      e.preventDefault;
      listId = parseInt(e.srcElement.dataset.id);
      el = $(".bcrumbs-list-view");
      if (LOAF.singleListView != null) {
        LOAF.singleListView.undelegateEvents();
      }
      LOAF.singleListView = new LOAF.SingleListView({
        collection: LOAF.customLists.where({
          id: listId
        })[0],
        el: el,
        caller: this._historyRep,
        type: "custom"
      });
      LOAF.singleListView.render();
      this.$el.hide();
      el.show();
      return LOAF.singleListView.postRender();
    },

    onAddNewList: function() {
      this.$('.new-list-name').show();
      return $('.bcrumbs-mycrumbs-section').append(LOAF.templates.bcListAdd);
    },

    render: function() {
      var html, missingImage;
      html = "";
      missingImage = "http://lorempixel.com/g/200/200/food";
      LOAF.customLists.each(function(list) {
        var obj;
        obj = {
          name: list.name,
          image1: list.size() > 0 ? list.models[0].get("image_url") : missingImage,
          image2: list.size() > 1 ? list.models[1].get("image_url") : missingImage,
          image3: list.size() > 2 ? list.models[2].get("image_url") : missingImage,
          id: list.id
        };

        html += Mustache.render(LOAF.templates.bcListViewList, obj);
        return html += LOAF.templates.bcListAdd;
      });
      return this.$(".bcrumbs-mycrumbs-section").html(html);
    }
  });

}).call(this);
