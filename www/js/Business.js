// Generated by CoffeeScript 1.4.0
(function() {
  var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  LOAF.Business = Backbone.Model.extend({
    initialize: function() {
      var current_categories, img_name_append;
      current_categories = ['active', 'arts', 'food', 'hotelstravel', 'localflavor', 'localservices', 'nightlife', 'restaurants', 'shopping', 'yoga', 'icecream', 'museums'];
      img_name_append = this.get("categories")[0][1];
      if (__indexOf.call(current_categories, img_name_append) < 0) {
        this.set("cover_image_url", "http://placehold.it/960x300&text=Business+Image+Missing+_" + img_name_append);
      } else {
        this.set("cover_image_url", "img/cat_" + img_name_append + ".jpg");
      }
      if (this.get("listIds") == null) {
        this.set("listIds", []);
      }
      return this.attributes.image_url = this.attributes.image_url.replace("ms.jpg", "ls.jpg");
    },
    addList: function(list) {
      if (!_.contains(this.attributes.listIds, list.id)) {
        this.attributes.listIds.push(list.id);
        return this.trigger("change", this.listIds);
      }
    },
    removeList: function(list) {
      this.attributes.listIds = _.without(this.attributes.listIds, list.id);
      return this.trigger("change", this.attributes.listIds);
    },
    search: function(term) {
      term = term.toUpperCase();
      return _.some(this.attributes, function(value, key) {
        switch (key) {
          case "name":
            return value.toUpperCase().indexOf(term) >= 0;
          case "categories":
            return _.some(value, function(cat) {
              return cat[0].toUpperCase().indexOf(term) >= 0;
            });
          default:
            return false;
        }
      });
    }
  });

}).call(this);
